(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e6769c7c"],{"0fa5":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"shop"},[a("van-nav-bar",{attrs:{title:"购物袋","left-arrow":""},on:{"click-left":t.back},scopedSlots:t._u([{key:"right",fn:function(){return[t.shopbagData.length>0?a("div",{on:{click:t.toggleState}},[t._v(" "+t._s(t.isEdit?"完成":"编辑")+" ")]):t._e()]},proxy:!0}])}),t.shopbagData.length>0?a("div",[a("div",{staticClass:"shopDetails"},[a("div",[a("div",{staticClass:"clearshopcar",on:{click:t.clearAllBox}},[t._v("清空购物车")])]),a("van-list",{attrs:{finished:t.finished,"finished-text":"哎呀，没有更多了",offset:"-90"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.shopbagData,(function(e,o){return a("van-swipe-cell",{key:e.sid,attrs:{disabled:!t.isEdit},scopedSlots:t._u([{key:"right",fn:function(){return[a("van-button",{staticClass:"shopbag-remove-btn",attrs:{color:"#D0563F",square:"",text:"删除"},on:{click:function(a){return t.deleteData([e.sid],o)}}})]},proxy:!0}],null,!0)},[a("div",{staticClass:"shopbox"},[a("div",{staticClass:"shopbox_left"},[a("div",{staticClass:"check"},[a("van-checkbox",{on:{change:t.simpleSelect},model:{value:e.isChecked,callback:function(a){t.$set(e,"isChecked",a)},expression:"item.isChecked"}})],1),a("div",{staticClass:"shopImg"},[a("img",{attrs:{src:e.small_img}})])]),a("div",{staticClass:"shopbox_right"},[a("div",{staticClass:"shopbox_right_top"},[t._v(t._s(e.name))]),a("div",{staticClass:"shopbox_right_middle"},[t._v(t._s(e.rule))]),a("div",{staticClass:"shopbox_right_bottom"},[a("div",{staticClass:"shopbox_right_bottom_left"},[t._v(t._s(e.price))]),a("div",{staticClass:"shopbox_right_bottom_right"},[a("van-stepper",{attrs:{theme:"round","button-size":"22","disable-input":""},on:{change:function(a){return t.changeDataNum(e.sid,e.count)}},model:{value:e.count,callback:function(a){t.$set(e,"count",a)},expression:"item.count"}})],1)])])])])})),1)],1),a("van-submit-bar",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}],attrs:{price:t.total,"button-text":"提交订单"},on:{submit:t.onSubmit}},[a("van-checkbox",{on:{click:t.ChooseAllData},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v("全选")])],1),a("van-submit-bar",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],attrs:{"button-text":"删除选择"},on:{submit:t.removeSelect}},[a("van-checkbox",{on:{click:t.ChooseAllData},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v("全选")])],1)],1):a("div",[a("van-empty",{attrs:{description:"购物袋没有数据，快去逛一逛!"}})],1)],1)},i=[],s=(a("4160"),a("a15b"),a("fb6a"),a("a434"),a("159b"),a("6b75"));function n(t){if(Array.isArray(t))return Object(s["a"])(t)}a("a4d3"),a("e01a"),a("d28b"),a("a630"),a("d3b7"),a("3ca3"),a("ddb0");function c(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}var r=a("06c5");function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(t){return n(t)||c(t)||Object(r["a"])(t)||l()}var d=a("5530"),u=(a("8d16"),a("2f62")),p={data:function(){return{isEdit:!1,checked:!1,shopbagData:[],shopbagAllData:[],start:0,count:6,loading:!0,finished:!1,total:0}},created:function(){this.getShopbagData()},computed:Object(d["a"])({},Object(u["c"])(["shopbagCount"])),methods:Object(d["a"])(Object(d["a"])({},Object(u["b"])(["changeShopbagCount"])),{},{clearAllBox:function(){console.log("清空购物车")},onSubmit:function(){var t=[];this.shopbagData.forEach((function(e){e.isChecked&&t.push(e.sid)})),console.log(t),0!==t.length?this.$router.push({name:"Pay",query:{sids:t.join("-")}}):this.$toast({message:"选择下单的商品",forbidClick:!0,duration:2e3})},getShopbagData:function(){var t=this,e=this.$cookie.get("loginToken");if(!e)return this.$toast({message:"请先登录",forbidClick:!0,duration:2e3}),this.$router.push("/login");this.$toast.loading({message:"购物车加载中",forbidClick:!0,duration:0}),this.axios({method:"GET",url:this.BaseUrl1+"/findAllShopcart",params:{appkey:this.appkey,tokenString:e}}).then((function(e){if(t.$toast.clear(),5e3==e.data.code){if(e.data.result.forEach((function(t){t.isChecked=!1})),t.shopbagAllData=e.data.result,t.shopbagData=t.shopbagAllData.slice(t.start,t.start+t.count),t.start+=t.count,t.shopbagAllData.length<t.count)return void(t.finished=!0);t.loading=!1}})).catch((function(e){t.$toast.clear(),console.log(e)}))},onLoad:function(){var t=this;setTimeout((function(){var e,a=t.shopbagAllData.slice(t.start,t.start+t.count);(e=t.shopbagData).push.apply(e,h(a)),t.start+=t.count,a.length<t.count?t.finished=!0:t.loading=!1}),1e3)},changeDataNum:function(t,e){var a=this,o=this.$cookie.get("loginToken");if(!o)return this.$toast({message:"请先登录",forbidClick:!0,duration:2e3}),this.$router.push("/login");this.axios({method:"POST",url:this.BaseUrl1+"/modifyShopcartCount",data:{appkey:this.appkey,tokenString:o,sid:t,count:e}}).then((function(t){6e3===t.data.code&&a.sum()})).catch((function(t){a.$toast.clear(),console.log(t)}))},back:function(){this.$router.go(-1)},toggleState:function(){this.isEdit=!this.isEdit},ChooseAllData:function(){var t=this;this.shopbagData.forEach((function(e){e.isChecked=t.checked}))},simpleSelect:function(){this.sum();for(var t=0;t<this.shopbagData.length;t++)if(!this.shopbagData[t].isChecked)return void(this.checked=!1);this.checked=!0},deleteData:function(t,e){var a=this,o=this.$cookie.get("loginToken");if(!o)return this.$toast({message:"请先登录",forbidClick:!0,duration:2e3}),this.$router.push("/login");this.axios({method:"POST",url:this.BaseUrl1+"/deleteShopcart",data:{appkey:this.appkey,tokenString:o,sids:JSON.stringify(t)}}).then((function(o){if(7e3==o.data.code)if(void 0!==e)a.shopbagData.splice(e,1),a.changeShopbagCount(a.shopbagCount-1),a.simpleSelect();else{for(var i=0;i<a.shopbagData.length;i++)a.shopbagData[i].isChecked&&(a.shopbagData.splice(i,1),i--);a.changeShopbagCount(a.shopbagCount-t.length),a.sum()}a.$toast({message:o.data.msg,forbidClick:!0,duration:3e3})})).catch((function(t){a.$toast.clear(),console.log(t)}))},removeSelect:function(){var t=[];this.shopbagData.forEach((function(e){e.isChecked&&t.push(e.sid)})),0!==t.length?this.deleteData(t):this.$toast({message:"未选择删除商品",forbidClick:!0,duration:2e3})},sum:function(){var t=0;this.shopbagData.forEach((function(e){e.isChecked&&(t+=e.price*e.count)})),this.total=100*t}})},f=p,g=a("2877"),b=Object(g["a"])(f,o,i,!1,null,null,null);e["default"]=b.exports},"8d16":function(t,e,a){},a434:function(t,e,a){"use strict";var o=a("23e7"),i=a("23cb"),s=a("a691"),n=a("50c4"),c=a("7b0b"),r=a("65f0"),l=a("8418"),h=a("1dde"),d=a("ae40"),u=h("splice"),p=d("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,g=Math.min,b=9007199254740991,v="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!u||!p},{splice:function(t,e){var a,o,h,d,u,p,m=c(this),k=n(m.length),C=i(t,k),x=arguments.length;if(0===x?a=o=0:1===x?(a=0,o=k-C):(a=x-2,o=g(f(s(e),0),k-C)),k+a-o>b)throw TypeError(v);for(h=r(m,o),d=0;d<o;d++)u=C+d,u in m&&l(h,d,m[u]);if(h.length=o,a<o){for(d=C;d<k-o;d++)u=d+o,p=d+a,u in m?m[p]=m[u]:delete m[p];for(d=k;d>k-o+a;d--)delete m[d-1]}else if(a>o)for(d=k-o;d>C;d--)u=d+o-1,p=d+a-1,u in m?m[p]=m[u]:delete m[p];for(d=0;d<a;d++)m[d+C]=arguments[d+2];return m.length=k-o+a,h}})}}]);
//# sourceMappingURL=chunk-e6769c7c.a180fa93.js.map